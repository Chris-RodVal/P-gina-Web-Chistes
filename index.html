<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chistes M√©dicos (Sanos)</title>
  <style>
    :root{
      --bg:#0b0f14; --panel:#121822; --accent:#4dd0e1; --text:#eaf2f7; --muted:#9fb3c8; --ok:#7bd389;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 600px at 20% -10%, #0f1622 0, #0b0f14 55%) no-repeat, var(--bg);
      color:var(--text); display:flex; min-height:100svh; align-items:center; justify-content:center; padding:24px;
    }
    .app{
      width:min(920px, 100%); background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.00));
      border:1px solid rgba(255,255,255,0.08); border-radius:24px; padding:22px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.35), inset 0 0 0 1px rgba(255,255,255,0.02);
      backdrop-filter: blur(6px);
    }
    header{display:flex; gap:14px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:16px}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{
      width:40px; height:40px; border-radius:12px; display:grid; place-items:center;
      background: conic-gradient(from 210deg, #00e5ff, #a7ffeb, #00e5ff);
      color:#001a1f; font-weight:900; box-shadow:0 6px 18px rgba(0,229,255,0.25);
    }
    h1{font-size:1.25rem; margin:0}
    .sub{color:var(--muted); font-size:.9rem}
    .controls{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    select, button, .chip{border-radius:10px; border:1px solid rgba(255,255,255,0.10); background:var(--panel); color:var(--text)}
    select{padding:10px 12px}
    .chip{padding:9px 12px; font-size:.9rem; display:flex; gap:8px; align-items:center}
    .chip input{accent-color:var(--accent)}
    .btn{
      padding:12px 16px; font-weight:700; letter-spacing:.2px; cursor:pointer;
      background:linear-gradient(180deg, var(--accent), #22b8cf); border:none; color:#001a1f;
      box-shadow:0 10px 24px rgba(77,208,225,0.35);
    }
    .btn:active{transform:translateY(1px)}
    .secondary{background:transparent; color:var(--text); border:1px solid rgba(255,255,255,0.18)}
    .wrap{
      background:rgba(8,12,18,0.65); border:1px solid rgba(255,255,255,0.06); border-radius:18px;
      padding:18px; margin-top:10px;
    }
    blockquote{
      margin:0; font-size:1.25rem; line-height:1.55; background:linear-gradient(180deg, rgba(77,208,225,0.06), transparent);
      border-left:4px solid var(--accent); padding:16px 18px; border-radius:12px; position:relative;
    }
    blockquote::before{
      content:"‚Äú"; position:absolute; left:10px; top:-8px; font-size:40px; color:rgba(255,255,255,0.15)
    }
    .meta{display:flex; justify-content:space-between; align-items:center; gap:8px; margin-top:10px; color:var(--muted); font-size:.9rem}
    .meta .ok{color:var(--ok)}
    footer{margin-top:16px; display:flex; gap:8px; flex-wrap:wrap; align-items:center}
    .hint{color:var(--muted); font-size:.85rem}
    @media (max-width:560px){
      blockquote{font-size:1.1rem}
      .controls{flex-direction:column; align-items:stretch}
      .btn{width:100%}
    }
  </style>
</head>
<body>
  <main class="app" role="main" aria-labelledby="title">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true">Rx</div>
        <div>
          <h1 id="title">Chistes M√©dicos (Sanos)</h1>
          <div class="sub">Humor saludable para guardias largas üòÑ</div>
        </div>
      </div>
      <div class="controls">
        <label class="chip" title="Filtra por categor√≠a">
          <span>Filtro</span>
          <select id="category">
            <option value="todas">Todas las categor√≠as</option>
            <option value="medicina">Medicina (general)</option>
            <option value="guardia">Guardia/Turno</option>
            <option value="pediatria">Pediatr√≠a</option>
            <option value="anatomia">Anatom√≠a</option>
            <option value="farmacologia">Farmacolog√≠a</option>
            <option value="quirurgico">Quir√∫rgico</option>
            <option value="saludpublica">Salud p√∫blica</option>
            <option value="geniales">Limpios (no m√©dicos)</option>
          </select>
        </label>
        <label class="chip" title="Prioriza chistes m√©dicos">
          <input type="checkbox" id="soloMed" checked />
          <span>Priorizar m√©dicos</span>
        </label>
        <button class="btn" id="newJoke">üé≤ Nuevo chiste</button>
        <button class="btn secondary" id="copyJoke" title="Copiar al portapapeles">üìã Copiar</button>
      </div>
    </header>

    <section class="wrap" aria-live="polite" aria-atomic="true">
      <blockquote id="jokeText">Pulsa ‚ÄúNuevo chiste‚Äù para empezar. Prometemos humor con consentimiento informado.</blockquote>
      <div class="meta">
        <span id="catLabel">Categor√≠a: ‚Äî</span>
        <span id="progress">0 / 0 vistos</span>
      </div>
    </section>

    <footer>
      <span class="hint">Sugerencia: usa el filtro para tematizar (p.ej., ‚ÄúGuardia‚Äù). No se repiten hasta agotar la lista.</span>
    </footer>
  </main>

  <script>
    // === Repertorio de chistes (60+) ‚Äî sanos, principalmente m√©dicos ===
    const JOKES = [
      {t:"‚ÄîDoctor, me duele aqu√≠, aqu√≠ y aqu√≠. ‚ÄîUsted tiene el dedo fracturado.", c:"medicina"},
      {t:"‚ÄîDoctor, vengo a que me lea los labios. ‚ÄîClaro: ‚ÄòNO TENGO TURNOS‚Äô", c:"medicina"},
      {t:"La evidencia dice que el caf√© no cura la guardia‚Ä¶ pero mejora la adherencia.", c:"medicina"},
      {t:"Diagn√≥stico diferencial de la guardia: 1) Sue√±o. 2) M√°s sue√±o. 3) Sue√±o refractario.", c:"medicina"},
      {t:"‚Äî¬øQu√© tiene el paciente? ‚ÄîHipertensi√≥n. ‚Äî¬øY el residente? ‚ÄîHipertensi√≥n+resignaci√≥n.", c:"medicina"},
      {t:"Si el paciente dice ‚Äúno me duele nada‚Äù y el residente dice ‚Äúno me falta nada‚Äù, ambos mienten.", c:"medicina"},
      {t:"La bata blanca es como la capa de invisibilidad pero para el descanso.", c:"medicina"},
      {t:"La √∫nica cosa que sube en l√≠nea recta en el hospital: la cantidad de WhatsApps del grupo.", c:"medicina"},
      {t:"‚ÄîDoctor, ¬ømi operaci√≥n fue un √©xito? ‚ÄîS√≠‚Ä¶ y aprendimos algo nuevo para la pr√≥xima.", c:"medicina"},
      {t:"Protocolo universal: si el computador se cuelga, el paciente mejora por placebo tecnol√≥gico.", c:"medicina"},
      {t:"Historia cl√≠nica resumida: Motivo de consulta: Google me dijo. Impresi√≥n diagn√≥stica: Dr. Googleitis.", c:"medicina"},
      {t:"Interconsulta al servicio de Milagros: cuando todo sali√≥ bien a pesar de todo.", c:"medicina"},
      {t:"En urgencias no existe el ‚Äòminuto‚Äô: existe el ‚Äòya voy‚Äô cu√°ntico.", c:"medicina"},
      {t:"‚Äî¬øCu√°nto demora el resultado? ‚ÄîEntre ‚Äòsale altiro‚Äô y ‚Äòlleg√≥ el alta‚Äô", c:"medicina"},
      {t:"La escala de dolor deber√≠a medir del 0 al ‚Äòme atendieron por orden de llegada‚Äô", c:"medicina"},
      {t:"Guardia tranquila: fen√≥meno meteorol√≥gico con probabilidad 0%.", c:"guardia"},
      {t:"Pron√≥stico nocturno: 100% de consultas cuando destapas tu comida.", c:"guardia"},
      {t:"Regla de guardia: si dices ‚Äòhoy est√° piola‚Äô, invocas 7 ambulancias.", c:"guardia"},
      {t:"El desfibrilador moral de la guardia: el primer sorbo de caf√© a las 03:17.", c:"guardia"},
      {t:"Turno de 12 horas: unidad b√°sica de medida del desorden circadiano.", c:"guardia"},
      {t:"El timbre de urgencias tiene inteligencia: suena cuando cierras los ojos.", c:"guardia"},
      {t:"‚ÄîDoctor, mi hijo no come verduras. ‚ÄîDiagn√≥stico: selectitis infantil aguda.", c:"pediatria"},
      {t:"Pediatr√≠a en una frase: el paciente llora y el m√©dico tambi√©n (por dentro).", c:"pediatria"},
      {t:"Dosis pedi√°trica universal: una pegatina por buen paciente.", c:"pediatria"},
      {t:"‚Äî¬øCu√°l es el ant√≠doto del berrinche? ‚ÄîTiempo, paciencia y una marraqueta extra.", c:"pediatria"},
      {t:"Si el juguete suena, el ni√±o se calma; si el computador suena, el m√©dico se altera.", c:"pediatria"},
      {t:"Mi m√∫sculo favorito es el ‚Äòdelto-ando‚Äô, porque siempre ando.", c:"anatomia"},
      {t:"El h√∫mero es el √∫nico hueso con permiso para hacer chistes.", c:"anatomia"},
      {t:"‚Äî¬øD√≥nde est√° el amor? ‚ÄîEn el coraz√≥n‚Ä¶ y en el pericardio por si llueve.", c:"anatomia"},
      {t:"La anatom√≠a te ense√±a que el cuerpo es perfecto: excepto mi postura en la guardia.", c:"anatomia"},
      {t:"‚Äî¬øCu√°l es el √≥rgano m√°s musical? ‚ÄîEl t√≠mpano; siempre est√° afinado.", c:"anatomia"},
      {t:"Farmacolog√≠a aplicada: caf√© v√≠a oral, dosis c/‚Äòcuando pesta√±eo‚Äô", c:"farmacologia"},
      {t:"Interacciones peligrosas: caf√© + turno de noche = taquicardia con felicidad.", c:"farmacologia"},
      {t:"Efecto adverso de estudiar farmacolog√≠a: querer poner posolog√≠a a la vida.", c:"farmacologia"},
      {t:"‚Äî¬øTiene alergias? ‚ÄîS√≠, a los ‚Äòno hay stock‚Äô de farmacia.", c:"farmacologia"},
      {t:"El placebo m√°s potente: ‚Äòya lleg√≥ el resultado‚Äô", c:"farmacologia"},
      {t:"La regla del cirujano: mide dos veces, corta una, y caf√© tres.", c:"quirurgico"},
      {t:"‚Äî¬øInstrumentista listo? ‚ÄîM√°s lista que el residente el lunes.", c:"quirurgico"},
      {t:"Si dices ‚Äòcirug√≠a corta‚Äô, el bistur√≠ se r√≠e.", c:"quirurgico"},
      {t:"Cirug√≠a mayor ambulatoria: mayor para el paciente, ambulatoria para el caf√©.", c:"quirurgico"},
      {t:"Checklist de quir√≥fano: 1) Paciente 2) Equipo 3) M√∫sica motivacional", c:"quirurgico"},
      {t:"La prevenci√≥n no se aplaude porque no se ve; pero se nota cuando falta.", c:"saludpublica"},
      {t:"Vacuna del buen humor: esquema completo con refuerzo cada lunes.", c:"saludpublica"},
      {t:"Determinante social del √°nimo del residente: fin de mes.", c:"saludpublica"},
      {t:"Si la educaci√≥n es salud, este chiste es prescripci√≥n cultural.", c:"saludpublica"},
      {t:"‚Äî¬øQu√© es un brote? ‚ÄîCuando todos cuentan el mismo chiste y se contagia la risa.", c:"saludpublica"},
      {t:"El estetoscopio sirve para o√≠r soplos y para fingir que ya vas.", c:"medicina"},
      {t:"‚ÄîDoctor, ¬øqu√© es ‚Äòayuno‚Äô? ‚ÄîExplique con empat√≠a al paciente‚Ä¶ y al residente.", c:"medicina"},
      {t:"Paciente: ‚Äòno me duele nada‚Äô. Signos vitales: ‚Äòplot twist‚Äô.", c:"medicina"},
      {t:"Triaje emocional: verde si hay caf√©, amarillo si se acab√≥, rojo si era descafeinado.", c:"guardia"},
      {t:"‚Äî¬øCu√°l es su dolor? ‚ÄîEl que empieza cuando suena el timbre. ‚ÄîDiagn√≥stico: refuerzo condicionado.", c:"medicina"},
      {t:"Alta administrativa: la cirug√≠a m√°s compleja del hospital.", c:"medicina"},
      {t:"Regla de oro: si todo est√° tranquilo, revisa la hora‚Ä¶ es cambio de turno.", c:"guardia"},
      {t:"Electrolitos del residente: Na (na‚Äô que dormir), K (qu√© sue√±o).", c:"medicina"},
      {t:"Unidad de tiempo hospitalaria: ‚Äòun momentito‚Äô = 7 a 21 min.", c:"medicina"},
      {t:"El diagn√≥stico m√°s r√°pido: ‚Äòno imprime‚Äô.", c:"medicina"},
      {t:"Signo de Murphy (versi√≥n guardia): si te sientas, suena la ambulancia.", c:"guardia"},
      {t:"Anamnesis avanzada: ‚Äò¬øqu√© tom√≥?‚Äô ‚Äî‚ÄòTurno de noche‚Äô.", c:"medicina"},
      {t:"‚Äî¬øCu√°l es el colmo de un jardinero? ‚ÄîQue siempre lo dejen plantado.", c:"geniales"},
      {t:"‚Äî¬øY de un electricista? ‚ÄîQue no ‚Äòresista‚Äô sus chispazos de humor.", c:"geniales"},
      {t:"‚Äî¬øPor qu√© el libro fue al m√©dico? ‚ÄîPorque ten√≠a lombrices‚Ä¶ de lectura.", c:"geniales"},
      {t:"‚Äî¬øQu√© hace una abeja en el gimnasio? ‚ÄîZum-ba.", c:"geniales"},
      {t:"‚Äî¬øCu√°l es el animal m√°s antiguo? ‚ÄîLa cebra, porque est√° en blanco y negro.", c:"geniales"},
      {t:"‚Äî¬øQu√© le dijo una impresora a otra? ‚Äî‚Äò¬øEsa hoja es tuya o es impresi√≥n m√≠a?‚Äô", c:"geniales"},
      {t:"‚ÄîProfesor, ¬øme castiga por algo que no hice? ‚ÄîNo. ‚Äî¬°Qu√© bien! Porque no hice la tarea.", c:"geniales"},
      {t:"Mi meta fitness: que el ascensor me salude por mi nombre.", c:"geniales"},
      {t:"Se me cay√≥ el internet. Confirmo que la casa sigue en su lugar.", c:"geniales"},
      {t:"El caf√© me habl√≥: ‚Äòdeja de culparme por todo‚Äô.", c:"geniales"}
    ];

    // ‚Äî‚Äî‚Äî L√≥gica de filtrado y no-repetici√≥n ‚Äî‚Äî‚Äî
    const categoryEl = document.getElementById('category');
    const soloMedEl = document.getElementById('soloMed');
    const jokeTextEl = document.getElementById('jokeText');
    const catLabelEl = document.getElementById('catLabel');
    const progressEl = document.getElementById('progress');
    const newBtn = document.getElementById('newJoke');
    const copyBtn = document.getElementById('copyJoke');

    let pool = [];
    let order = [];
    let seenCount = 0;
    let pointer = -1;

    function fisherYates(arr){
      for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function buildPool(){
      const cat = categoryEl.value;
      const prioritized = soloMedEl.checked;
      let filtered = JOKES.filter(j => cat==='todas' ? true : j.c===cat);

      if (cat==='todas' && prioritized){
        const medical = JOKES.filter(j=>['medicina','guardia','pediatria','anatomia','farmacologia','quirurgico','saludpublica'].includes(j.c));
        filtered = filtered.concat(medical); // aumenta prob. de m√©dicos
      }
      pool = filtered;
      order = fisherYates([...pool.keys()]);
      pointer = -1;
      seenCount = 0;
      updateProgress();
    }

    function updateProgress(){
      progressEl.textContent = `${seenCount} / ${pool.length} vistos`;
    }

    function prettyCat(c){
      const map = {
        medicina:"Medicina", guardia:"Guardia/Turno", pediatria:"Pediatr√≠a", anatomia:"Anatom√≠a",
        farmacologia:"Farmacolog√≠a", quirurgico:"Quir√∫rgico", saludpublica:"Salud p√∫blica", geniales:"Limpios"
      };
      return map[c] || c;
    }

    function showNext(){
      if (!pool.length){
        jokeTextEl.textContent = "No hay chistes para esa combinaci√≥n. Cambia el filtro.";
        catLabelEl.textContent = "Categor√≠a: ‚Äî";
        progressEl.textContent = "0 / 0 vistos";
        return;
      }
      pointer++;
      if (pointer >= order.length){
        // Re-armar orden para otro ciclo
        order = fisherYates([...pool.keys()]);
        pointer = 0;
        seenCount = 0;
      }
      const idx = order[pointer];
      const joke = pool[idx];
      jokeTextEl.textContent = joke.t;
      catLabelEl.textContent = `Categor√≠a: ${prettyCat(joke.c)}`;
      // contar vistos √∫nicos dentro del ciclo actual
      if (pointer < pool.length) seenCount = Math.min(pointer+1, pool.length);
      updateProgress();
    }

    categoryEl.addEventListener('change', ()=>{ buildPool(); });
    soloMedEl.addEventListener('change', ()=>{ buildPool(); });
    newBtn.addEventListener('click', showNext);
    copyBtn.addEventListener('click', async ()=>{
      const text = `${jokeTextEl.textContent} ‚Äî (${catLabelEl.textContent})`;
      try{
        await navigator.clipboard.writeText(text);
        copyBtn.textContent = "‚úÖ Copiado";
        setTimeout(()=>copyBtn.textContent="üìã Copiar", 1200);
      }catch(e){
        const ta = document.createElement('textarea');
        ta.value = text; document.body.appendChild(ta);
        ta.select(); document.execCommand('copy'); ta.remove();
        copyBtn.textContent = "‚úÖ Copiado";
        setTimeout(()=>copyBtn.textContent="üìã Copiar", 1200);
      }
    });

    // Inicializa al cargar
    document.addEventListener('DOMContentLoaded', buildPool);
  </script>
</body>
</html>
